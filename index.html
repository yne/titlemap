<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8"/>
	<script>
		$=function(sel,base){return (base||document).querySelector(sel)};
		$$=function(sel,base){return [].slice.call((base||document).querySelectorAll(sel))};
		El=function(name,attr){var el=document.createElement(name);for(var i in attr)el.setAttribute(i,attr[i]);return el;}
	</script>
	<script src="TitleMap.js"></script>
	<script src="TitleMap.utils.js"></script>
	<script src="TitleMap.GUI.js"></script>
	<link rel="stylesheet" href="style.css"></style>
</head>
<body onload="P=new TitleMap()">
<button class="aside_open" onclick="$('aside').hidden=false;">File</button>

<aside _hidden><button class="close" onclick="$('aside').hidden=true;">&times;</button>
<form onsubmit="var e=this.elements;try{
	P.fromImageFile(+e.size.value,e.file.files[0],P.showTitles);
	}catch(e){console.error(e)};return false;">
	<legend><input type="submit" value="Load"/> from image dump 
	<select onchange="if(this.value)location.href=this.value">
		<option value="">Examples List</option>
		<option value="http://i.imgur.com/3qppUHk.png">Zelda NES</option>
		<option value="http://i.imgur.com/b66Y95q.png">Zelda GBC</option>
		<option value="http://www.vgmaps.com/Atlas/SuperNES/LegendOfZelda-ALinkToThePast-LightWorld.png">Zelda SNES (LW)</option>
		<option value="http://www.vgmaps.com/Atlas/SuperNES/LegendOfZelda-ALinkToThePast-DarkWorld.png">Zelda SNES (DW)</option>
	</select></legend>
	<select name="size" title="Titles size"><option>8</option><option selected>16</option><option>32</option></select>
	<input name="file" type="file" accept="image/*" title="Image file" required/>
</form>

<form onsubmit="var e=this.elements;try{
	var f={};[].slice.call(e.files.files).forEach(function(file){
		f[(file.name.match(/\w+$/)||['_'])[0]]=file;
	});P.fromFiles(f.json,f.map,f.ttl,P.showTitles);
	}catch(e){console.error(e)};return false;">
	<legend><input type="submit" value="Load"/> from files [.map+.ttl+.json]</legend>
	<input name="files" accept="*.map;*.ttl;*.json" type="file" multiple required/>
</form>

<form onsubmit="var e=this.elements;try{
	P.toHref($('[name=title]',this),$('[name=map]',this),$('[name=info]',this));
	}catch(e){console.error(e)}return false;">
	<legend><input type="submit" value="Save"/> to files</legend>
	<a name="title" download="a.ttl">titles</a>
	<a name="map" download="a.map">map</a>
	<a name="info" download="a.json">info</a>
</form>
</aside>
<div class="map_container">
	<canvas id="view"></canvas>
</div>

<div class="hud">
	<div class="titles_container"><span id="titles"/></div>
</div>

</body>
</html>